<!--pages/admin/admin.wxml-->
<view class="page">
  <!-- ç®¡ç†å‘˜éªŒè¯ -->
  <view class="auth-section card" wx:if="{{!isAdmin}}">
    <view class="section-title">ç®¡ç†å‘˜ç™»å½•</view>
    <view class="auth-form">
      <view class="form-item">
        <text class="form-label">ç®¡ç†å‘˜å¯†ç </text>
        <input 
          class="form-input" 
          type="password"
          placeholder="è¯·è¾“å…¥ç®¡ç†å‘˜å¯†ç " 
          value="{{adminPassword}}"
          bindinput="onPasswordInput"
        />
      </view>
      <button class="auth-btn btn-primary" bindtap="adminLogin">ç™»å½•</button>
    </view>
  </view>

  <!-- ç®¡ç†å‘˜é¢æ¿ -->
  <view wx:if="{{isAdmin}}">
    <!-- ç»Ÿè®¡æ¦‚è§ˆ -->
    <view class="stats-overview card">
      <view class="section-title">ä»Šæ—¥ç»Ÿè®¡</view>
      <view class="stats-grid">
        <view class="stat-card">
          <text class="stat-number">{{todayStats.bookings}}</text>
          <text class="stat-label">ä»Šæ—¥é¢„çº¦</text>
        </view>
        <view class="stat-card">
          <text class="stat-number">{{todayStats.revenue}}</text>
          <text class="stat-label">ä»Šæ—¥æ”¶å…¥(Â¥)</text>
        </view>
        <view class="stat-card">
          <text class="stat-number">{{todayStats.usage}}</text>
          <text class="stat-label">ä½¿ç”¨ç‡(%)</text>
        </view>
        <view class="stat-card">
          <text class="stat-number">{{todayStats.users}}</text>
          <text class="stat-label">æ´»è·ƒç”¨æˆ·</text>
        </view>
      </view>
    </view>

    <!-- åœºåœ°ç®¡ç† -->
    <view class="court-management card">
      <view class="section-title">åœºåœ°ç®¡ç†</view>
      <view class="court-list">
        <view 
          class="court-item"
          wx:for="{{courts}}" 
          wx:key="id"
        >
          <view class="court-info">
            <text class="court-name">{{item.name}}</text>
            <text class="court-status status-{{item.status}}">{{getStatusText(item.status)}}</text>
          </view>
          <view class="court-actions">
            <button 
              class="action-btn btn-secondary"
              bindtap="toggleCourtStatus"
              data-id="{{item.id}}"
              data-status="{{item.status}}"
            >
              {{item.status === 'maintenance' ? 'æ¢å¤ä½¿ç”¨' : 'è®¾ä¸ºç»´æŠ¤'}}
            </button>
          </view>
        </view>
      </view>
    </view>

    <!-- é¢„çº¦ç®¡ç† -->
    <view class="booking-management card">
      <view class="section-title">
        <text>é¢„çº¦ç®¡ç†</text>
        <button class="refresh-btn" bindtap="refreshBookings">åˆ·æ–°</button>
      </view>
      <view class="booking-list">
        <view 
          class="booking-item"
          wx:for="{{recentBookings}}" 
          wx:key="id"
        >
          <view class="booking-info">
            <text class="booking-court">{{item.courtName}}</text>
            <text class="booking-time">{{formatTime(item.createTime)}}</text>
            <text class="booking-user">{{item.userInfo.name}} - {{item.userInfo.phone}}</text>
          </view>
          <view class="booking-status">
            <text class="status-badge status-{{item.status}}">{{getBookingStatusText(item.status)}}</text>
          </view>
          <view class="booking-actions">
            <button 
              class="action-btn btn-danger"
              bindtap="cancelBooking"
              data-id="{{item.id}}"
              wx:if="{{item.status === 'confirmed' || item.status === 'paid'}}"
            >
              å–æ¶ˆ
            </button>
          </view>
        </view>
      </view>
    </view>

    <!-- ç³»ç»Ÿè®¾ç½® -->
    <view class="system-settings card">
      <view class="section-title">ç³»ç»Ÿè®¾ç½®</view>
      <view class="settings-list">
        <view class="setting-item" bindtap="exportData">
          <view class="setting-icon">ğŸ“Š</view>
          <text class="setting-text">å¯¼å‡ºæ•°æ®</text>
          <text class="setting-arrow">></text>
        </view>
        <view class="setting-item" bindtap="clearCache">
          <view class="setting-icon">ğŸ—‘ï¸</view>
          <text class="setting-text">æ¸…ç†ç¼“å­˜</text>
          <text class="setting-arrow">></text>
        </view>
        <view class="setting-item" bindtap="systemMaintenance">
          <view class="setting-icon">âš™ï¸</view>
          <text class="setting-text">ç³»ç»Ÿç»´æŠ¤</text>
          <text class="setting-arrow">></text>
        </view>
        <view class="setting-item" bindtap="adminLogout">
          <view class="setting-icon">ğŸšª</view>
          <text class="setting-text">é€€å‡ºç®¡ç†</text>
          <text class="setting-arrow">></text>
        </view>
      </view>
    </view>
  </view>
</view>